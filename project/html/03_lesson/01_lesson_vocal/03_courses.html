

<div id="courses" class="courses common-container">
    <div class="scroll-spacer">
        <div class="content-wrapper sticky-element">
            <h2 class="content-title">JU 3단계 교육과정</h2>
            <div class="courses-grid">
                <div class="course-card" style="--course-card-i:1;">
                    <div class="course-content">
                        <div class="course-features">
                            <h3>발성과정</h3>
                            <p>보컬의 기초, 올바른 발성법을 배우는 단계</p>
                            <p>어디에 어떤 힘을 주는지 정확히 학습하여 음역대 상승과 음색의 일정함을 확보합니다. 성대 손상을 방지하고 목 컨디션을 안정화시키는 JU만의 체계적인 발성 메소드를 통해 보컬의 탄탄한 기초를 다집니다.</p>
                        </div>
                        <div class="course-image">
                            <img src="https://images.pexels.com/photos/7586662/pexels-photo-7586662.jpeg" alt="">
                        </div>
                    </div>
                </div>

                <div class="course-card" style="--course-card-i:2;">
                    <div class="course-content">
                        <div class="course-features">
                            <h3>발성적용과정</h3>
                            <p>배운 발성을 실제 노래에 적용하는 실전 단계</p>
                            <p>발성과정에서 배운 힘을 다양한 노래에 적용하여 안정적인 음정과 음색으로 노래를 완성합니다. 변화무쌍한 곡에 대한 대응력을 향상시키며, 매 수업마다 실습을 통해 즉시 적용할 수 있도록 지도합니다.</p>
                        </div>
                        <div class="course-image">
                            <img src="https://images.pexels.com/photos/7586662/pexels-photo-7586662.jpeg" alt="">
                        </div>
                    </div>
                </div>
                
                <div class="course-card" style="--course-card-i:3;">
                    <div class="course-content">
                        <div class="course-features">
                            <h3>표현과정</h3>
                            <p>완성된 발성으로 감정을 담아 표현하는 최종 단계</p>
                            <p>추상적이지 않은 구체적인 표현법을 교육하여 발성의 힘을 분위기에 맞게 조절합니다. 과한 부분은 조절하고 부족한 표현은 보완하여 균형감 있는 감정 표현을 완성시킵니다.</p>
                        </div>
                        <div class="course-image">
                            <img src="https://images.pexels.com/photos/7586662/pexels-photo-7586662.jpeg" alt="">
                        </div>
                    </div>
                </div>
            </div>  
        </div>
    </div>
</div>

    <!-- Process Section -->
    <div id="process" class="process common-container">
        <div class="content-wrapper">
            <h2 class="content-title"><span>JU만의 특별한 교육 방식</span></h2>
            <div class="process-steps">
                <div class="step">
                    <div class="step-number">1</div>
                    <h4>체계적인 3단계 과정</h4>
                    <p>발성과정 → 발성적용과정 → 표현과정으로 완성하는 전문 보컬 교육</p>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <h4>개인별 맞춤 교육</h4>
                    <p>개인별 문제점 정확한 파악 및 해결로 맞춤형 학습 계획을 수립합니다.</p>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <h4>모든 수업 완벽 구성</h4>
                    <p>모든 수업에 발성과정과 발성적용과정을 포함하여 체계적으로 진행됩니다.</p>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <h4>이론과 실습의 균형</h4>
                    <p>발성과 발성적용의 완벽한 균형으로 지속가능한 보컬 실력을 구축합니다.</p>
                </div>
                <div class="step">
                    <div class="step-number">5</div>
                    <h4>차별화된 교육법</h4>
                    <p>추상적이지 않은 구체적인 표현법으로 확실한 실력 향상을 도모합니다.</p>
                </div>
            </div>
        </div>
    </div>


<script type="module">
// app.js

//import { initGSAP } from './gsapUtils.js';
import { initGSAP } from 'https://restarea92.github.io/ju/modules/gsapUtils.js';

const app = {

    // ========== Configuration ==========
    CONFIG: {
        VERSION: '1.0.0',
    },

    // ========== DOM Elements Cache ==========
    elements: {
        // Base element for the courses section
        baseElement: document.querySelector('#courses'),

        // Elements within the courses section
        get contentWrapper() { return this.baseElement?.querySelector('.content-wrapper')},
        get stickyElement() { return this.baseElement?.querySelector('.sticky-element')},
        get spacer() { return this.baseElement?.querySelector('.scroll-spacer')},
        get trigger() { return this.baseElement?.querySelector('.scroll-spacer')},

        // Grid elements
        get gridBox() { return this.baseElement?.querySelector('.courses-grid')},
        get gridCards() { 
            return gsap.utils.toArray(this.gridBox?.querySelectorAll('.course-card'));
        },
    },


    init() {
        // Initialize GSAP
        if (!initGSAP()) {
            console.error('GSAP initialization failed.');
            return;
        }
        this.initScroll();
    },

    // ========== Init Scroll ==========
    /**
     * Initialize scroll
     */
    initScroll() {
        const contentWrapper = this.elements.contentWrapper;
        const stickyElement = this.elements.stickyElement;

        const trigger = this.elements.trigger;
        const spacer = this.elements.spacer;

        const gridBox = this.elements.gridBox;
        const gridCards = this.elements.gridCards;
        const gridCardCount = gridCards.length;
        // 100 / gridCardCount;
        const gridCardRatio = 100 / (gridCardCount + 1);
        const gridCardHeight = parseFloat(getComputedStyle(gridCards[0]).height);

        gsap.set(gridCards, {
            force3D: true,
            z: 0,
            yPercent: (i) => { return 90 + (i * 5); },
            opacity: 0,
            scale: 1.1,
            filter: "brightness(1)",
        });
        
        gsap.set(contentWrapper, {
            paddingTop: "4rem",
        });

        gsap.set(stickyElement, {
            position: "sticky",
            top: "1rem",
            zIndex: 1,
        });

        gsap.set(spacer, {
            height: `calc(clamp(2000px, 200vh, 3000px)`,
        });

        gridCards.forEach((card, i) => {
            if (i === 0) {
                gsap.set(card, {
                    force3D: true,
                    yPercent: 0,
                    opacity: 1,
                    scale: 1,
                    filter: "brightness(1)",
                });
            }

            if (i > 0) {
                const timelineReady = this.createTimeline({
                    scrub: true,
                    ease: "none",
                    start:  `top+=${(i - 1) * gridCardRatio}% top+=40%`,
                    end: `top+=${(i -1) * gridCardRatio }% 10%`,

                });
                timelineReady.to(card, {
                    ease: "power1.inOut",
                    yPercent: 95,
                    scale: 1.1,
                    filter: "brightness(1)",
                }, 0);

                const timeline1 = this.createTimeline({
                    start:  `top+=${i * gridCardRatio}% top+=40%`,
                    end: `top+=${(i) * gridCardRatio }% 10%`,

                });
                timeline1.to(card, {
                    ease: "power1.inOut",
                    yPercent: 0,
                    scale: 1,
                    filter: "brightness(1)",
                }, 0);

                timeline1.to(card, {
                    ease: "expo.out",
                    opacity: 1,
                }, 0);
            }


            if (i < gridCardCount - 1) {
                const timeline2 = this.createTimeline({
                    start:  `top+=${(i + 1) * gridCardRatio}% top+=25%`,
                    end: `top+=${(i + 1) * gridCardRatio }% 10%`,
                });
                timeline2.to(card, {
                ease: "expo.inOut",
                    yPercent: -3,
                    opacity: 1,
                    scale: 0.95,
                    filter: "brightness(0.95)",
                }, 0);
            }

            if (i < gridCardCount - 2) {
                const timeline3 = this.createTimeline({
                    start:  `top+=${(i + 2) * gridCardRatio}% top+=30%`,
                    end: `top+=${(i + 2) * gridCardRatio }% 10%`,
                });
                timeline3.to(card, {
                ease: "expo.inOut",
                    opacity: 0.5,
                    scale: 0.9,
                    yPercent: -4,
                    filter: "brightness(0.6)",
                }, 0);
            }

            if (i < gridCardCount - 3) {
                const timeline4 = this.createTimeline({
                    start:  `top+=${(i + 3) * gridCardRatio}% top+=35%`,
                    end: `top+=${(i + 3) * gridCardRatio }% 10%`,
                });
                
                timeline4.to(card, {
                ease: "expo.inOut",
                    opacity: 0,
                    scale: 0.8,
                    yPercent: -5,
                    filter: "brightness(0.9)",
                }, 0);
            } 


        });
        
    },
    


    createTimeline(options = {}) {
        return gsap.timeline({
            scrollTrigger: {
                trigger: this.elements.trigger,
                start: "top top",
                end: "bottom bottom",
                scrub: 1, 
                ...options,
            }
        });
    },

};


document.addEventListener('DOMContentLoaded', () => {
    app.init();
});

</script>
